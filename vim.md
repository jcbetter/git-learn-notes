### vim

[toc]

vim 是 Linux 下广泛使用的文本编辑器。

![vim键盘图](E:\Espressif\vim\vim键盘图.gif)



### 1. 工作模式

vim 分为三种模式：**命令模式**、**输入模式**、**底线命令模式**。

<img src="C:\Users\金成\Desktop\vim-vi-workmodel.png" style="zoom:50%;" />

#### 1.1 命令模式

vim 启动默认进入命令模式。在命令模式下，敲击键盘会被 vim 识别成命令而非输入字符。

例如，在命令模式下，`k`、`j`、`h`、`l` 分别表示向上下左右移动光标。

**在命令模式下，按下 `i` 会切换到输入模式。**此时可以编辑文本内容。



#### 1.2 输入模式

在输入模式中，敲击键盘都会被 vim 识别成输入字符，可以正常对文本进行编辑。

**在输入模式下，按下 `Esc` 会退出输入模式，切换到命令模式。**



#### 1.3 底线命令模式

**在命令模式下，按下 `:` 会切换到底线命令模式。**

底线命令模式可以输入很多命令。例如，`:w` 表示保存文件；`:wq` 表示保存文件并退出。

**在底线命令模式下，按下 `Esc` 会切换到命令模式。**



### 2. 命令

所有以 `:` 开头的命令都是底线命令模式下的命令，其余为命令模式下的命令。



#### 2.1 移动光标

|       命令        |                动作                |
| :---------------: | :--------------------------------: |
|       **k**       |      **光标向上移动一个字符**      |
|       **j**       |      **光标向下移动一个字符**      |
|       **h**       |      **光标向左移动一个字符**      |
|       **l**       |      **光标向右移动一个字符**      |
| **[n] [k,j,h,l]** |    **向特定方向移动 n 个单位**     |
|   **Ctrl + f**    |        **屏幕向下移动一页**        |
|   **Ctrl + b**    |        **屏幕向上移动一页**        |
|   **Ctrl + d**    |        **屏幕向下移动半页**        |
|   **Ctrl + u**    |        **屏幕向上移动半页**        |
|       **+**       |         **光标移到下一行**         |
|       **-**       |         **光标移到上一行**         |
|  **[n] [Space]**  |     **光标向右移动 n 个单位**      |
|  **[n] [Enter]**  |       **光标向下移动 n 行**        |
|       **0**       |         **光标移动到行首**         |
|       **$**       |         **光标移动到行尾**         |
|       **H**       | **光标移动到当前屏幕最上方的行首** |
|       **M**       |  **光标移动到当前屏幕中央的行首**  |
|       **L**       | **光标移动到当前屏幕最下方的行首** |
|       **G**       |    **光标移动到文档的最后一行**    |
|     **[n] G**     |    **光标移动到文档的第 n 行**     |
|      **gg**       |     **光标移动到文档的第一行**     |



#### 2.2 搜索与替换

|                        命令                        |                             动作                             |
| :------------------------------------------------: | :----------------------------------------------------------: |
|                     **/[str]**                     |                 **向光标之下搜索下一个 str**                 |
|                     **?[str]**                     |                 **向光标之上搜索下一个 str**                 |
|                       **n**                        |                    **重复前一个搜索动作**                    |
|                       **N**                        |                  **反向进行前一个搜索动作**                  |
|          **:[n1],[n2]s/[str1]/[str2]/g**           |         **将 n1 行与 n2 行之间的 str1 替换成 str2**          |
|  **:1,$s/[str1]/[str2]/g** **:s/[str1]/[str2]/g**  |        **将第一行与最后一行之间的 str1 替换成 str2**         |
| **:1,$s/[str1]/[str2]/gc** **:s/[str1]/[str2]/gc** | **将第一行与最后一行之间的 str1 替换成 str2，替换前提示用户确认** |



#### 2.3 删除、复制、粘贴

|     命令     |                     动作                     |
| :----------: | :------------------------------------------: |
|   **x, X**   |           **向后、前删除一个字符**           |
|  **[n] x**   |            **向后删除 n 个字符**             |
|    **dd**    |             **删除光标所在的行**             |
|  **[n] dd**  |        **删除光标所在行的向下 n 行**         |
|   **d1G**    |          **删除光标所在行到第一行**          |
|    **dG**    |         **删除光标所在行到最后一行**         |
|    **d0**    |        **删除光标所在位置到该行行首**        |
|    **d$**    |        **删除光标所在位置到该行行尾**        |
|    **yy**    |              **复制光标所在行**              |
|  **[n] yy**  |        **复制光标所在行的向下 n 行**         |
|   **y1G**    |          **复制光标所在行到第一行**          |
|    **yG**    |         **复制光标所在行到最后一行**         |
|    **y0**    |        **复制光标所在位置到该行行首**        |
|    **y$**    |        **复制光标所在位置到该行行尾**        |
|   **p, P**   | **将复制的内容粘贴在光标所在行的下、上一行** |
|    **u**     |              **撤销上一个动作**              |
| **Ctrl + r** |              **重做上一个动作**              |
|    **.**     |              **重复前一个动作**              |



#### 2.4 切换模式

|  命令   |                             动作                             |
| :-----: | :----------------------------------------------------------: |
|  **i**  |           **切换到输入模式，从光标所在处开始输入**           |
|  **I**  | **切换到输入模式，从光标所在行的第一个非空格字符处开始输入** |
|  **a**  |     **切换到输入模式，从光标所在处的下一个字符开始输入**     |
|  **A**  |   **切换到输入模式，从光标所在行的最后一个字符处开始输入**   |
|  **o**  |     **切换到输入模式，从光标所在行的下一行输入新的一行**     |
|  **O**  |     **切换到输入模式，从光标所在行的上一行输入新的一行**     |
|  **r**  |          **进入取代模式，取代光标所在处的一个字符**          |
|  **R**  |    **进入取代模式，连续向后取代字符，直到按下 Esc 为止**     |
| **Esc** |               **退出编辑模式，切换到命令模式**               |



#### 2.5 保存与退出

|           命令            |                           动作                           |
| :-----------------------: | :------------------------------------------------------: |
|          **:w**           |                         **保存**                         |
|          **:w!**          |                       **强制保存**                       |
|          **:q**           |                         **退出**                         |
|          **:q!**          |                     **不保存并退出**                     |
|          **:wq**          |                      **保存并退出**                      |
|          **ZZ**           |                      **保存并退出**                      |
|          **ZQ**           |                     **不保存并退出**                     |
|      **:w [文件名]**      |               **将编辑的内容另存为新文件**               |
| **:[n1],[n2] w [文件名]** |        **将 n1 行到 n2 行之间的内容另存为新文件**        |
|      **:r [文件名]**      | **在编辑的内容中读入另一个文件的内容到光标所在行的后面** |
|       **！ [命令]**       |           **暂时离开 vim 到 shell 中执行命令**           |



####  2.6 配置

|          命令          |        动作         |
| :--------------------: | :-----------------: |
|    **:set  number**    |    **显示行号**     |
|   **:set nonumber**    |   **不显示行号**    |
| **set encoding=utf-8** | **使用 utf-8 编码** |
|   **set autoindent**   |    **自动缩进**     |
|   **set tabstop=4**    |  **设置 Tab 长度**  |
|   **set cursorline**   | **高亮光标所在行**  |
|   **set showmatch**    | **高亮匹配的括号**  |
|    **set hlsearch**    | **高亮搜索的结果**  |


